(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[298],{6718:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var r=s(5155),a=s(2115),n=s(5695);function i(e){let{className:t="",variant:s="primary",size:i="medium",showIcon:l=!0,returnUrl:o,customerId:c}=e,[d,u]=(0,a.useState)(!1);(0,n.useRouter)();let m="flex items-center justify-center rounded-md font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none";switch(s){case"primary":m+=" bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500";break;case"secondary":m+=" bg-gray-200 hover:bg-gray-300 text-gray-800 focus:ring-gray-500";break;case"outline":m+=" border border-gray-300 hover:bg-gray-50 text-gray-700 focus:ring-blue-500";break;case"text":m+=" hover:bg-gray-100 text-gray-700 focus:ring-blue-500"}switch(i){case"small":m+=" text-sm px-3 py-1.5";break;case"medium":m+=" text-base px-4 py-2";break;case"large":m+=" text-lg px-6 py-3"}let x=async()=>{u(!0);try{let e="/.netlify/functions/api/subscriptions/portal-session",t=new URLSearchParams;o&&t.append("returnUrl",o),c&&t.append("customerId",c),t.toString()&&(e+="?".concat(t.toString()));let s=await fetch(e),r=await s.json();if(!s.ok)throw Error(r.error||"Failed to get portal URL");if(r.url)window.location.href=r.url;else throw Error("No portal URL received")}catch(e){console.error("Error getting customer portal URL:",e)}finally{u(!1)}};return(0,r.jsx)("div",{children:(0,r.jsx)("button",{className:"".concat(m," ").concat(t),onClick:x,disabled:d,children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Loading..."]}):(0,r.jsxs)(r.Fragment,{children:[l&&(0,r.jsxs)("svg",{className:"mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Manage Subscription"]})})})}},7428:(e,t,s)=>{Promise.resolve().then(s.bind(s,8823))},8823:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(5155),a=s(2115),n=s(6203),i=s(5317),l=s(5695),o=s(6718);function c(){let[e,t]=(0,a.useState)(!1);(0,l.useRouter)();let s=async()=>{try{t(!0);let e=window.location.href,s=await fetch("/api/subscriptions/portal-session?returnUrl=".concat(encodeURIComponent(e)),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to get portal URL")}let{url:r}=await s.json();window.location.href=r}catch(e){console.error("Error accessing subscription portal:",e),alert("Could not access subscription portal. Please try again later.")}finally{t(!1)}};return(0,r.jsx)("div",{children:(0,r.jsx)("button",{onClick:s,disabled:e,className:"btn btn-secondary",children:e?"Loading...":"Subscription Portal"})})}function d(){let[e,t]=(0,a.useState)(!0),[s,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),g=(0,l.useRouter)();return((0,a.useEffect)(()=>{let e=(0,n.xI)(),s=(0,n.hg)(e,async e=>{if(e){h(!0),d(e);try{let t=(0,i.aU)(),s=(0,i.H9)(t,"users",e.uid),r=await (0,i.x7)(s);if(r.exists()){let e=r.data();e.hasActiveSubscription&&e.currentSubscriptionId&&m({status:e.subscriptionStatus||"unknown",plan:e.currentPlan||"unknown",nextBillDate:e.nextBillDate?new Date(e.nextBillDate.toDate()).toLocaleDateString():"unknown",customerId:e.paddleCustomerId||null})}}catch(e){console.error("Error fetching subscription data:",e)}t(!1)}else h(!1),g.push("/login")});return()=>s()},[g]),null===x)?(0,r.jsx)("div",{className:"p-8 text-center",children:"Loading..."}):(0,r.jsxs)("div",{className:"max-w-4xl mx-auto p-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Account Management"}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Subscription Management"}),(0,r.jsx)("p",{className:"mb-4",children:"Manage your subscription settings, billing information, and payment methods."}),(0,r.jsx)(c,{})]}),(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Profile Information"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,r.jsx)("p",{className:"font-medium",children:null==s?void 0:s.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"User ID"}),(0,r.jsx)("p",{className:"font-mono text-sm truncate",children:null==s?void 0:s.uid})]})]})]}),u?(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Subscription"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Plan"}),(0,r.jsx)("p",{className:"font-medium",children:u.plan})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Status"}),(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("active"===u.status?"bg-green-100 text-green-800":"paused"===u.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:u.status})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Next Billing Date"}),(0,r.jsx)("p",{className:"font-medium",children:u.nextBillDate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Customer ID"}),(0,r.jsx)("p",{className:"font-mono text-sm truncate",children:u.customerId})]})]}),(0,r.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:(0,r.jsx)(o.A,{variant:"primary",returnUrl:"".concat(window.location.origin,"/account")})})]}):(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-8",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Subscription"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"You don't have an active subscription."}),(0,r.jsx)("a",{href:"/pricing",className:"inline-flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"View Pricing"})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,146,235,525,441,684,358],()=>t(7428)),_N_E=e.O()}]);