(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{3005:(e,t,a)=>{Promise.resolve().then(a.bind(a,9747))},3747:(e,t,a)=>{"use strict";a.d(t,{N:()=>l,q:()=>r});var s=a(6104);let l=async()=>{let e=s.j2.currentUser;if(e){let t=await e.getIdToken();try{if(!(await fetch("/api/auth/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:t})})).ok)throw Error("Failed to set session");return!0}catch(e){console.error("Error setting session:",e)}}return!1},r=async()=>{try{return await fetch("/api/auth/logout",{method:"POST",credentials:"include"}),localStorage.removeItem("user"),sessionStorage.clear(),!0}catch(e){return console.error("Error clearing session:",e),document.cookie="session=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT; secure",localStorage.removeItem("user"),sessionStorage.clear(),!1}}},6104:(e,t,a)=>{"use strict";a.d(t,{hJ:()=>c,j2:()=>o,kA:()=>u,sv:()=>l.sv});var s=a(3915),l=a(6203),r=a(5317),i=a(858),n=a(1427);a(6864);let d=0===(0,s.Dk)().length?(0,s.Wp)({apiKey:"AIzaSyAx0PxN59MqrmedLsjEiTqVvt7eq5S2GeQ",authDomain:"paddle-bda5d.firebaseapp.com",projectId:"paddle-bda5d",storageBucket:"paddle-bda5d.firebasestorage.app",messagingSenderId:"911290966881",appId:"1:911290966881:web:084733c0aa07f473c8db20",measurementId:"G-1R6HX54FVL"}):(0,s.Dk)()[0],o=(0,l.xI)(d);o.useDeviceLanguage();let c=new l.HF;c.addScope("profile"),c.addScope("email"),c.setCustomParameters({prompt:"select_account"}),new l.IX;let u=(0,r.aU)(d);(0,i.c7)(d),(0,n.Uz)(d)},9747:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(5155),l=a(2115),r=a(5695),i=a(6104),n=a(6203),d=a(3747);function o(e){let{className:t=""}=e,a=(0,r.useRouter)(),[o,c]=(0,l.useState)(!1),u=async()=>{try{c(!0),await (0,n.CI)(i.j2),(0,d.q)(),a.replace("/login")}catch(e){console.error("Error signing out:",e)}finally{c(!1)}};return(0,s.jsx)("button",{onClick:u,disabled:o,className:"flex items-center ".concat(t),children:o?(0,s.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"}):"Logout"})}var c=a(6766);function u(e){var t,a,l;let{user:r}=e;return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(null==r?void 0:r.photoURL)?(0,s.jsx)(c.default,{src:r.photoURL,alt:r.displayName||"Profile",width:64,height:64,className:"rounded-full",priority:!0}):(0,s.jsx)("div",{className:"h-16 w-16 rounded-full bg-violet-100 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-2xl text-violet-600",children:((null==r?void 0:null===(a=r.displayName)||void 0===a?void 0:a[0])||(null==r?void 0:null===(l=r.email)||void 0===l?void 0:l[0])||"?").toUpperCase()})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:(null==r?void 0:r.displayName)||(null==r?void 0:null===(t=r.email)||void 0===t?void 0:t.split("@")[0])||"User"}),(0,s.jsx)("p",{className:"text-gray-500",children:null==r?void 0:r.email})]})]}),(0,s.jsxs)("div",{className:"mt-6 border-t pt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"Account Status"}),(0,s.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800",children:"Active"})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"Email Verified"}),(0,s.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat((null==r?void 0:r.emailVerified)?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:(null==r?void 0:r.emailVerified)?"Verified":"Pending"})]})]})]})}var m=a(3554);let x={clientToken:"test_20b36b874ecf58915be7d6f8057",sellerId:"31089",prices:{standard:{month:"pri_01jv178w9jst683rgyjb6w18qx",year:"pri_01jv17anj5xnsta6hvv209sdyq"},premium:{month:"pri_01jv17e3xm8mdsd22866ce8417",year:"pri_01jv17f8370m2vyvspr2btg84s"}},planDetails:{standard:{name:"Standard Plan",features:["Core application features","Email support","Basic analytics"]},premium:{name:"Premium Plan",features:["All Standard features","Priority support","Advanced analytics","Custom integrations","Team collaboration tools"]}}};var h=a(5317);function p(e){return e===x.prices.standard.month?{name:"Standard Monthly",tier:"standard",interval:"month",description:"Basic features with monthly billing",features:x.planDetails.standard.features}:e===x.prices.standard.year?{name:"Standard Yearly",tier:"standard",interval:"year",description:"Basic features with yearly billing (save 16%)",features:x.planDetails.standard.features}:e===x.prices.premium.month?{name:"Premium Monthly",tier:"premium",interval:"month",description:"Advanced features with monthly billing",features:x.planDetails.premium.features}:e===x.prices.premium.year?{name:"Premium Yearly",tier:"premium",interval:"year",description:"Advanced features with yearly billing (save 16%)",features:x.planDetails.premium.features}:null}function v(e){let{onSuccess:t,onError:a}=e,[s,r]=(0,l.useState)(!1),[i,d]=(0,l.useState)(null),[o,c]=(0,l.useState)(null);return(0,l.useEffect)(()=>{{let e=new URLSearchParams(window.location.search),t=e.get("checkout_id"),a=e.get("customer_id");t&&d(t),a&&c(a)}},[]),(0,l.useEffect)(()=>{(async()=>{if(i&&o&&!s){r(!0);try{let e=(0,n.xI)().currentUser;if(!e)throw Error("User not authenticated");console.log("Processing checkout - calling verification endpoint");let a=await fetch("/api/subscriptions/verify-checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({checkoutId:i,customerId:o,userId:e.uid,email:e.email})});if(!a.ok){console.log("Subscription details not available yet, webhooks will update later"),window.history.replaceState({},document.title,window.location.pathname),t&&t({subscriptionId:"pending",status:"processing",customerId:o});return}let s=await a.json();if(console.log("Subscription details retrieved from API:",s),s.subscriptionId&&"pending"!==s.subscriptionId){let t=(0,h.aU)(),a=(0,h.H9)(t,"users",e.uid);await (0,h.BN)(a,{hasActiveSubscription:!0,currentSubscriptionId:s.subscriptionId,subscriptionStatus:s.status,currentPlan:s.planId,nextBillDate:s.nextBillDate?new Date(s.nextBillDate):null,paddleCustomerId:o,lastCheckoutDate:new Date},{merge:!0})}else console.log("No valid subscription ID received, waiting for webhook events");window.history.replaceState({},document.title,window.location.pathname),t&&t(s)}catch(e){console.error("Error processing checkout:",e),a&&a(e)}finally{r(!1)}}})()},[i,o,s,t,a]),null}x.prices.standard.month,x.planDetails.standard.features,x.prices.standard.year,x.planDetails.standard.features,x.prices.premium.month,x.planDetails.premium.features,x.prices.premium.year,x.planDetails.premium.features;let b=(0,l.createContext)(void 0);function g(e){let{children:t}=e,[a,r]=(0,l.useState)("light");return(0,l.useEffect)(()=>{let e=localStorage.getItem("theme");e?(r(e),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")):window.matchMedia("(prefers-color-scheme: dark)").matches&&(r("dark"),document.documentElement.classList.add("dark"))},[]),(0,s.jsx)(b.Provider,{value:{theme:a,setTheme:e=>{r(e),localStorage.setItem("theme",e),"dark"===e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}},children:t})}function f(){let e=(0,l.useContext)(b);if(!e)throw Error("useTheme must be used within a ThemeProvider");return e}function w(e){let{isOpen:t,onClose:a}=e,{theme:l,setTheme:r}=f();return t?(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:(0,s.jsx)("div",{className:"w-full max-w-md bg-white dark:bg-slate-800 rounded-2xl shadow-xl overflow-hidden transform transition-all",children:(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white",children:"Settings"}),(0,s.jsx)("button",{onClick:a,className:"text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-white transition-colors",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-md font-medium text-slate-700 dark:text-slate-200 mb-3",children:"Theme"}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsxs)("button",{onClick:()=>r("light"),className:"flex flex-col items-center p-4 rounded-lg border-2 transition-all ".concat("light"===l?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600"),children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-white border border-slate-200 flex items-center justify-center mb-2 shadow-sm",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}),(0,s.jsx)("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:"Light Mode"})]}),(0,s.jsxs)("button",{onClick:()=>r("dark"),className:"flex flex-col items-center p-4 rounded-lg border-2 transition-all ".concat("dark"===l?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600"),children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-slate-800 border border-slate-700 flex items-center justify-center mb-2 shadow-sm",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-slate-200",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),(0,s.jsx)("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:"Dark Mode"})]})]})]}),(0,s.jsxs)("div",{className:"pt-4 border-t border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h4",{className:"text-md font-medium text-slate-700 dark:text-slate-200 mb-3",children:"About"}),(0,s.jsxs)("div",{className:"p-4 bg-slate-50 dark:bg-slate-700/30 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center mb-3",children:[(0,s.jsx)(c.default,{src:"/paFire_logo.png",alt:"paFire Logo",width:24,height:24,className:"mr-2"}),(0,s.jsx)("h5",{className:"font-semibold text-slate-900 dark:text-white",children:"paFire"})]}),(0,s.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-300",children:"Version 1.0.0"}),(0,s.jsx)("p",{className:"text-sm text-slate-600 dark:text-slate-300 mt-2",children:"A Firebase & Paddle integration showcase application."}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)("a",{href:"https://github.com/username/pademo",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),"View on GitHub"]})})]})]})]})]})})}):null}function j(){let e=(0,r.useRouter)(),[t,a]=(0,l.useState)(i.j2.currentUser),[d,b]=(0,l.useState)(!1),[j,k]=(0,l.useState)("month"),[y,N]=(0,l.useState)({}),[S,D]=(0,l.useState)(!1),[P,_]=(0,l.useState)(null),[C,I]=(0,l.useState)(null),[E,A]=(0,l.useState)([]),[M,T]=(0,l.useState)(null);(0,l.useEffect)(()=>{let t=(0,n.hg)(i.j2,async t=>{if(!t){e.replace("/login");return}a(t),F(t.uid),d&&z()});return console.log("Paddle Config:",{clientToken:x.clientToken?"".concat(x.clientToken.substring(0,5),"..."):"missing",sellerId:x.sellerId,standardMonthPrice:x.prices.standard.month,premiumMonthPrice:x.prices.premium.month}),()=>t()},[d,e]);let z=async()=>{if(!d){console.error("Paddle is not loaded yet");return}try{let e={items:[{quantity:1,priceId:x.prices.standard[j]},{quantity:1,priceId:x.prices.premium[j]}]},t=await window.Paddle.PricePreview(e),a={};t.data.details.lineItems.forEach(e=>{e.price.id===x.prices.standard[j]?a.standard=e.formattedTotals.subtotal:e.price.id===x.prices.premium[j]&&(a.premium=e.formattedTotals.subtotal)}),N(a)}catch(e){console.error("Error fetching prices:",e)}};(0,l.useEffect)(()=>{d&&(z(),console.log("Environment Price IDs:",{standardMonth:"pri_01jv178w9jst683rgyjb6w18qx",standardYear:"pri_01jv17anj5xnsta6hvv209sdyq",premiumMonth:"pri_01jv17e3xm8mdsd22866ce8417",premiumYear:"pri_01jv17f8370m2vyvspr2btg84s"}),console.log("Paddle Config Price IDs:",x.prices))},[d,j]);let U=e=>{if(!d){console.error("Paddle is not loaded yet"),_("Error: Paddle is not loaded yet. Please refresh the page.");return}_("Opening checkout...");let a=x.prices[e][j],s="pri_01h8xz97pj0000000000000000";console.log("Starting checkout for plan: ".concat(e,", cycle: ").concat(j)),console.log("Using price ID: ".concat(a," (fallback available: ").concat(s,")")),console.log("User data:",{email:null==t?void 0:t.email,uid:null==t?void 0:t.uid});try{console.log("Paddle Config:",{clientToken:x.clientToken?"".concat(x.clientToken.substring(0,5),"..."):"missing",sellerId:x.sellerId,priceId:a}),window.Paddle.Checkout.open({items:[{priceId:a,quantity:1}],settings:{displayMode:"overlay",theme:"light",locale:"en"},customer:{email:(null==t?void 0:t.email)||""},customData:{userId:(null==t?void 0:t.uid)||""},successCallback:e=>{console.log("Checkout success callback triggered",e),_("Processing your subscription...")},closeCallback:e=>{console.log("Checkout closed",e),_(null)},errorCallback:e=>{var a;console.error("Checkout error:",e),e&&("product_not_found"===e.code||(null===(a=e.message)||void 0===a?void 0:a.includes("product not found")))?(console.log("Trying checkout with fallback price ID..."),setTimeout(()=>{try{window.Paddle.Checkout.open({items:[{priceId:s,quantity:1}],settings:{displayMode:"overlay",theme:"light",locale:"en"},customer:{email:(null==t?void 0:t.email)||""},customData:{userId:(null==t?void 0:t.uid)||""}})}catch(e){console.error("Error with fallback price ID:",e),_("Error with fallback price ID: ".concat(e instanceof Error?e.message:"Unknown error"))}},1e3)):_("Error during checkout: ".concat(e.message||e.reason||"Unknown error"))}})}catch(e){console.error("Error opening Paddle checkout:",e),_("Failed to open checkout: ".concat(e instanceof Error?e.message:"Unknown error"))}},B=async e=>{if(console.log("Paddle event:",e),"subscription.created"===e.name&&t)try{var a,s,l,r,i,n,d,o,c,u,m,x,p,v,b,g,f;let w=(0,h.aU)(),j=(0,h.rJ)(w,"users",t.uid,"transactions");console.log("Full Paddle subscription.created payload:",JSON.stringify(e,null,2));let k=null===(a=e.data.items)||void 0===a?void 0:a[0],y=e.data.id;if(!y){console.log("No valid subscription ID in event, not saving to Firebase");return}let N={userId:t.uid,subscriptionId:y,product:{id:null!==(c=null==k?void 0:null===(s=k.product)||void 0===s?void 0:s.id)&&void 0!==c?c:"",name:null!==(u=null==k?void 0:null===(l=k.product)||void 0===l?void 0:l.name)&&void 0!==u?u:""},amountPaid:null!==(m=null==k?void 0:null===(r=k.totals)||void 0===r?void 0:r.total)&&void 0!==m?m:0,currency:null!==(x=null==k?void 0:null===(n=k.price)||void 0===n?void 0:null===(i=n.unit_price)||void 0===i?void 0:i.currency_code)&&void 0!==x?x:"USD",paymentStatus:null!==(p=e.data.status)&&void 0!==p?p:"active",customerEmail:null!==(b=null!==(v=null===(d=e.data.customer)||void 0===d?void 0:d.email)&&void 0!==v?v:t.email)&&void 0!==b?b:"",customerId:null!==(g=null===(o=e.data.customer)||void 0===o?void 0:o.id)&&void 0!==g?g:"",nextBillDate:e.data.next_billed_at?new Date(e.data.next_billed_at):null,startDate:e.data.started_at?new Date(e.data.started_at):null,quantity:null!==(f=null==k?void 0:k.quantity)&&void 0!==f?f:1,timestamp:new Date};console.log("Subscription transaction data:",N),await (0,h.BN)((0,h.H9)(j,y),N),console.log("Subscription saved to Firebase");let S=(0,h.H9)(w,"users",t.uid);await (0,h.BN)(S,{hasActiveSubscription:!0,lastTransactionDate:new Date,currentPlan:N.product.id,subscriptionStatus:"active",currentSubscriptionId:y},{merge:!0})}catch(t){console.error("Error saving subscription data:",t),console.error("Event data:",e)}else"checkout.completed"===e.name&&console.log("Checkout completed. Waiting for subscription.created event.")},L=async e=>{try{let r=(0,h.aU)(),i=(0,h.H9)(r,"users",e),n=await (0,h.x7)(i);if(n.exists()){var t,a,s,l;let e=n.data(),r={hasActive:e.hasActiveSubscription||!1,plan:e.currentPlan||null,status:e.subscriptionStatus||"inactive",lastTransaction:(null===(t=e.lastTransactionDate)||void 0===t?void 0:t.toDate())||null,product:e.product||null,customerId:e.paddleCustomerId||null,subscriptionId:e.currentSubscriptionId||null,nextBillDate:(null===(a=e.nextBillDate)||void 0===a?void 0:a.toDate())||null,canceledAt:(null===(s=e.subscriptionCanceledAt)||void 0===s?void 0:s.toDate())||null,scheduled_change:e.scheduled_change||null,cancellationEffectiveDate:(null===(l=e.cancellationEffectiveDate)||void 0===l?void 0:l.toDate())||null};console.log("Fetched subscription status:",r),I(r)}}catch(e){console.error("Error fetching subscription:",e)}},R=async e=>{try{let t=(0,h.aU)(),a=(0,h.rJ)(t,"users",e,"transactions"),s=(0,h.P)(a,(0,h.My)("timestamp","desc"),(0,h.AB)(1)),l=(await (0,h.GG)(s)).docs.map(e=>{var t;let a=e.data();if(a.rawData){let e=a.rawData;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){console.error("Failed to parse rawData string:",e)}e.scheduled_change&&C&&a.subscriptionId===C.subscriptionId&&I(t=>({...t,scheduled_change:e.scheduled_change}))}return a.scheduled_change&&C&&a.subscriptionId===C.subscriptionId&&I(e=>({...e,scheduled_change:a.scheduled_change})),{id:e.id,...a,planDetails:p(null===(t=a.product)||void 0===t?void 0:t.id)}});if(A(l),null==C?void 0:C.subscriptionId){let a=(0,h.H9)(t,"users",e,"subscriptions",C.subscriptionId),s=await (0,h.x7)(a);if(s.exists()){let e=s.data();if(e.rawData){let t=e.rawData;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){console.error("Failed to parse subscription rawData string:",e)}t.scheduled_change&&I(e=>({...e,scheduled_change:t.scheduled_change}))}(e.scheduled_change||e.cancellationEffectiveDate)&&I(t=>{var a;return{...t,scheduled_change:e.scheduled_change||(null==t?void 0:t.scheduled_change),cancellationEffectiveDate:(null===(a=e.cancellationEffectiveDate)||void 0===a?void 0:a.toDate())||(null==t?void 0:t.cancellationEffectiveDate)}})}}}catch(e){console.error("Error fetching transactions:",e)}},F=async e=>{try{var t,a,s,l,r,i;let n=(0,h.aU)();if(null==C?void 0:C.subscriptionId){let l=(0,h.H9)(n,"users",e,"subscriptions",C.subscriptionId),r=await (0,h.x7)(l);if(r.exists()){let e=r.data(),l={...e,id:r.id};if((null===(s=e.items)||void 0===s?void 0:null===(a=s[0])||void 0===a?void 0:null===(t=a.price)||void 0===t?void 0:t.unit_price)?(l.priceAmount=e.items[0].price.unit_price.amount,l.priceCurrency=e.items[0].price.unit_price.currency_code):e.price?"object"==typeof e.price?(l.priceAmount=e.price.amount,l.priceCurrency=e.price.currency):"string"==typeof e.price?l.formattedPrice=e.price:"number"==typeof e.price&&(l.priceAmount=e.price,l.priceCurrency=e.currency||"USD"):e.amount&&(l.priceAmount=e.amount,l.priceCurrency=e.currency||"USD"),e.billing_details||e.billingDetails){let t=e.billing_details||e.billingDetails;(t.amount||t.total)&&(l.priceAmount=t.amount||t.total,l.priceCurrency=t.currency||"USD")}T(l);return}}let d=(0,h.rJ)(n,"users",e,"subscriptions"),o=(0,h.P)(d,(0,h._M)("status","==","active"),(0,h.My)("createdAt","desc"),(0,h.AB)(1)),c=await (0,h.GG)(o);if(!c.empty){let e=c.docs[0].data(),t={...e,id:c.docs[0].id};if((null===(i=e.items)||void 0===i?void 0:null===(r=i[0])||void 0===r?void 0:null===(l=r.price)||void 0===l?void 0:l.unit_price)?(t.priceAmount=e.items[0].price.unit_price.amount,t.priceCurrency=e.items[0].price.unit_price.currency_code):e.price?"object"==typeof e.price?(t.priceAmount=e.price.amount,t.priceCurrency=e.price.currency):"string"==typeof e.price?t.formattedPrice=e.price:"number"==typeof e.price&&(t.priceAmount=e.price,t.priceCurrency=e.currency||"USD"):e.amount&&(t.priceAmount=e.amount,t.priceCurrency=e.currency||"USD"),e.billing_details||e.billingDetails){let a=e.billing_details||e.billingDetails;(a.amount||a.total)&&(t.priceAmount=a.amount||a.total,t.priceCurrency=a.currency||"USD")}T(t)}}catch(e){console.error("Error fetching subscription data:",e)}};(0,l.useEffect)(()=>{(null==t?void 0:t.uid)&&(async()=>{try{await L(t.uid),await F(t.uid),await R(t.uid);let e=(0,h.aU)(),a=(0,h.H9)(e,"users",t.uid),s=await (0,h.x7)(a);if(s.exists()){let e=s.data();if(e.scheduled_change&&I(t=>t?{...t,scheduled_change:e.scheduled_change}:t),e.rawData){let t=e.rawData;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){console.error("Failed to parse user rawData")}(null==t?void 0:t.scheduled_change)&&I(e=>e?{...e,scheduled_change:t.scheduled_change}:e)}}if(null==C?void 0:C.subscriptionId){let a=(0,h.H9)(e,"users",t.uid,"subscriptions",C.subscriptionId),s=await (0,h.x7)(a);if(s.exists()){let e=s.data();if(e.scheduled_change&&I(t=>t?{...t,scheduled_change:e.scheduled_change}:t),e.rawData){let t=e.rawData;if("string"==typeof t)try{t=JSON.parse(t)}catch(e){console.error("Failed to parse subscription rawData")}(null==t?void 0:t.scheduled_change)&&I(e=>e?{...e,scheduled_change:t.scheduled_change}:e)}}}let l=(0,h.rJ)(e,"users",t.uid,"transactions");for(let e of(await (0,h.GG)(l)).docs){let t=e.data(),a=null;if(t.rawData){let e=t.rawData;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){console.error("Failed to parse rawData")}(null==e?void 0:e.scheduled_change)&&(a=e.scheduled_change)}if(t.scheduled_change&&(a=t.scheduled_change),a){I(e=>e?{...e,scheduled_change:a}:e);break}}}catch(e){console.error("Error loading subscription data:",e)}})()},[t,null==C?void 0:C.subscriptionId]);let q=e=>{if(console.log("Checkout completed successfully:",e),_("Subscription checkout completed! Updating your subscription status..."),null==t?void 0:t.uid){if((null==e?void 0:e.subscriptionId)&&"pending"!==e.subscriptionId)try{let a=(0,h.aU)(),s=(0,h.H9)(a,"users",t.uid);(0,h.BN)(s,{hasActiveSubscription:!0,lastTransactionDate:new Date,currentPlan:e.planId||x.prices.standard.month,subscriptionStatus:"active",currentSubscriptionId:e.subscriptionId,paddleCustomerId:e.customerId,lastUpdated:new Date},{merge:!0}).then(()=>{console.log("Successfully updated user subscription from checkout data"),L(t.uid),R(t.uid)}).catch(e=>{console.error("Error updating subscription from checkout data:",e),setTimeout(()=>O(),2e3)})}catch(e){console.error("Error in immediate subscription update:",e),setTimeout(()=>O(),2e3)}else console.log("No subscription ID received yet, polling for updates..."),setTimeout(()=>{L(t.uid),R(t.uid),setTimeout(()=>{(null==C?void 0:C.hasActive)||_("Checkout completed, but subscription status not updated automatically. You can try updating manually.")},5e3)},3e3)}},H=e=>{console.error("Error during checkout:",e),_("There was an error processing your subscription. Please try again or contact support.")},O=async()=>{if(!t){console.error("No logged in user");return}try{_("Manually checking subscription status...");let e=(0,h.aU)(),a=(0,h.H9)(e,"users",t.uid,"tests","manual-check");await (0,h.BN)(a,{timestamp:new Date,operation:"manual-check"}),console.log("Firebase test write successful");let s=(0,h.H9)(e,"users",t.uid),l=t.email||"user-".concat(new Date().getTime(),"@example.com");await (0,h.BN)(s,{hasActiveSubscription:!0,lastTransactionDate:new Date,currentPlan:x.prices.standard.month,subscriptionStatus:"active",currentSubscriptionId:"manual-"+new Date().getTime(),paddleCustomerId:l,lastUpdated:new Date},{merge:!0}),console.log("Manually updated subscription status with customer ID:",l),_("Subscription status manually updated. Refreshing data..."),await L(t.uid),setTimeout(()=>{_(null)},3e3)}catch(e){console.error("Error in manual subscription update:",e),_("Error updating subscription: "+(e instanceof Error?e.message:"Unknown error"))}},G=async()=>{if(console.log("Opening customer portal with subscription data:",C),!t){_("No logged in user found");return}try{_("Opening customer portal..."),console.log("Customer info for portal:",{email:t.email,customerId:null==C?void 0:C.customerId});let e="https://sandbox-customer-portal.paddle.com/cpl_01jtqjeq79c64enc8qy3cs3zrm";console.log("Using portal URL:",e),window.open(e,"_blank"),setTimeout(()=>{_(null)},3e3)}catch(e){console.error("Error opening customer portal:",e),_("Error opening customer portal: "+(e instanceof Error?e.message:"Unknown error"))}},J=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";if("string"==typeof e&&e.includes("."))return e;let a="string"==typeof e?parseInt(e,10):e;return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:2,maximumFractionDigits:2}).format(a/100)},V=e=>e?e instanceof Date?e.toLocaleDateString():"object"==typeof e&&"seconds"in e?new Date(1e3*e.seconds).toLocaleDateString():"string"==typeof e?new Date(e).toLocaleDateString():"N/A":"N/A";return(0,s.jsx)(g,{children:(0,s.jsx)(()=>{var e,a,l,r,i,n,h,g,N,_,I,A,T,z,L,R,F,Y,W,X;let{theme:K}=f();return(0,s.jsxs)("div",{className:"min-h-screen ".concat("dark"===K?"dark bg-slate-900":"bg-gradient-to-br from-slate-50 to-slate-100"),children:[(0,s.jsx)(m.default,{src:"https://cdn.paddle.com/paddle/v2/paddle.js",onLoad:()=>{if(window.Paddle)try{console.log("Setting Paddle environment to sandbox"),window.Paddle.Environment.set("sandbox"),console.log("Setting up Paddle with token:",x.clientToken?"".concat(x.clientToken.substring(0,5),"..."):"missing"),window.Paddle.Setup({token:x.clientToken,eventCallback:B}),console.log("Paddle initialized successfully"),b(!0)}catch(e){console.error("Error initializing Paddle:",e)}else console.error("Paddle not available on window object")},onError:()=>{console.error("Failed to load Paddle script")}}),(0,s.jsx)(v,{onSuccess:q,onError:H}),(0,s.jsx)("nav",{className:"bg-white/80 dark:bg-slate-800/80 backdrop-blur-md sticky top-0 z-30 border-b border-slate-200/80 dark:border-slate-700/80",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(c.default,{src:"/paFire_logo.png",alt:"paFire Logo",width:32,height:32}),(0,s.jsx)("span",{className:"text-xl font-semibold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:"Dashboard"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("button",{onClick:()=>D(!0),className:"p-2 rounded-full text-slate-700 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-700/50 transition-colors","aria-label":"Settings",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})}),(0,s.jsx)(o,{className:"text-slate-700 hover:text-slate-900 dark:text-slate-300 dark:hover:text-white"})]})]})})}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[P&&(0,s.jsx)("div",{className:"mb-4 bg-green-50 border border-green-300 dark:bg-green-900/20 dark:border-green-700/40 text-green-800 dark:text-green-200 px-4 py-3 rounded-lg",children:P}),(!C||!C.hasActive)&&(0,s.jsxs)("div",{className:"mb-4 bg-blue-50 border border-blue-300 dark:bg-blue-900/20 dark:border-blue-700/40 text-blue-800 dark:text-blue-200 px-4 py-3 rounded-lg",children:[(0,s.jsx)("p",{className:"mb-2",children:"If you've completed checkout but your subscription isn't showing:"}),(0,s.jsx)("button",{onClick:O,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md",children:"Update Subscription Manually"})]}),!1,(()=>{if(C&&C.hasActive){if(C.scheduled_change&&"cancel"===C.scheduled_change.action&&C.scheduled_change.effective_at){var e;return(0,s.jsx)("div",{className:"mb-4 bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 p-4 rounded-md shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-amber-400 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,s.jsxs)("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:["This subscription is scheduled to be canceled on ",(null===(e=C.scheduled_change)||void 0===e?void 0:e.effective_at)?V(C.scheduled_change.effective_at):"soon","."]})]})})}if(C.cancellationEffectiveDate)return(0,s.jsx)("div",{className:"mb-4 bg-amber-50 dark:bg-amber-900/20 border-l-4 border-amber-400 p-4 rounded-md shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-amber-400 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,s.jsxs)("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:["This subscription is scheduled to be canceled on ",V(C.cancellationEffectiveDate),"."]})]})})}return null})(),C&&C.hasActive&&(0,s.jsx)("div",{className:"mb-8 bg-gradient-to-r from-blue-500 to-indigo-600 dark:from-blue-600 dark:to-indigo-700 rounded-2xl shadow-md overflow-hidden",children:(0,s.jsxs)("div",{className:"px-6 py-8 md:px-8 md:py-8 relative",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 -translate-y-24 translate-x-24 rounded-full bg-white/10 opacity-50"}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 w-48 h-48 translate-y-20 -translate-x-16 rounded-full bg-white/5 opacity-50"}),(0,s.jsxs)("div",{className:"relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-white mb-2",children:["Welcome, ",(null==t?void 0:t.displayName)||(null==t?void 0:null===(e=t.email)||void 0===e?void 0:e.split("@")[0]),"!"]}),(0,s.jsx)("p",{className:"text-blue-100 max-w-md",children:"Your subscription is active. Enjoy full access to all premium features."})]}),(0,s.jsx)("div",{className:"mt-6 pt-4 ",children:(0,s.jsx)("button",{onClick:G,className:"flex items-center justify-center w-full py-2 px-4 text-sm font-medium text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors",children:"Manage Subscription"})})]})]})}),(!C||!C.hasActive)&&(0,s.jsx)("div",{className:"mb-8 bg-gradient-to-r from-slate-700 to-slate-800 dark:from-slate-800 dark:to-slate-900 rounded-2xl shadow-md overflow-hidden",children:(0,s.jsxs)("div",{className:"px-6 py-8 md:px-8 md:py-8 relative",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 w-64 h-64 -translate-y-24 translate-x-24 rounded-full bg-white/10 opacity-20"}),(0,s.jsxs)("div",{className:"relative z-10 flex flex-col md:flex-row items-start md:items-center justify-between gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to Your Dashboard"}),(0,s.jsx)("p",{className:"text-slate-300 max-w-md mb-4",children:"Unlock all premium features by subscribing to one of our plans below. Get started today and experience the full power of our platform."}),(0,s.jsx)("button",{onClick:()=>{var e;null===(e=document.getElementById("subscription-plans"))||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"})},className:"px-6 py-2.5 bg-white text-slate-800 hover:bg-slate-100 dark:bg-slate-100 dark:hover:bg-white rounded-lg font-medium transition-colors",children:"View Plans"})]}),(0,s.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm p-5 rounded-xl hidden md:block",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 text-white mb-3",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-300",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{children:"Access all premium features"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 text-white mb-3",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-300",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{children:"Priority customer support"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 text-white",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-300",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{children:"Cancel anytime"})]})]})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"sticky top-24 space-y-6",children:[(0,s.jsx)(u,{user:t}),C&&(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200/80 dark:border-slate-700/50 p-5",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-slate-800 dark:text-white mb-4",children:"Subscription Status"}),(0,s.jsxs)("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800/30",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Current Plan"}),(0,s.jsx)("h4",{className:"text-xl font-bold text-slate-900 dark:text-white",children:C.plan?(null===(a=p(C.plan))||void 0===a?void 0:a.name)||"Standard Plan":"Free Plan"})]}),(0,s.jsx)("div",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("active"===C.status?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-200":"paused"===C.status?"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-200":"canceled"===C.status?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-200":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200"),children:C.status.charAt(0).toUpperCase()+C.status.slice(1)})]}),(0,s.jsxs)("div",{className:"mt-4",children:[C.nextBillDate&&(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Next Billing Date"}),(0,s.jsx)("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:V(C.nextBillDate)})]}),C.lastTransaction&&(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,s.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Last Payment"}),(0,s.jsx)("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:V(C.lastTransaction)})]}),C.subscriptionId&&(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Subscription ID"}),(0,s.jsxs)("span",{className:"font-mono text-xs text-slate-600 dark:text-slate-400",children:[C.subscriptionId.substring(0,8),"..."]})]})]}),C.scheduled_change&&"cancel"===C.scheduled_change.action&&"active"===C.status&&(0,s.jsx)("div",{className:"mt-4 bg-amber-50 border border-amber-100 dark:bg-amber-900/20 dark:border-amber-800/30 text-amber-800 dark:text-amber-200 px-4 py-3 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("p",{className:"font-medium",children:["This subscription is scheduled to be canceled on ",(null===(l=C.scheduled_change)||void 0===l?void 0:l.effective_at)?V(C.scheduled_change.effective_at):"soon"]}),(0,s.jsx)("p",{className:"text-sm mt-1",children:"Your access will continue until this date."})]})]})}),"canceled"===C.status&&(0,s.jsx)("div",{className:"mt-4 bg-red-50 border border-red-100 dark:bg-red-900/20 dark:border-red-800/30 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg",children:(0,s.jsxs)("p",{className:"text-sm",children:["Your subscription has been canceled",C.canceledAt?" on ".concat(V(C.canceledAt)):"","."]})})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)("button",{onClick:G,className:"flex items-center justify-center w-full py-2 px-4 text-sm font-medium text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 rounded-lg transition-colors",children:"Manage Subscription"})})]})})]})}),(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-8",children:[M&&(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200/80 dark:border-slate-700/50 p-6 overflow-hidden relative",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 w-48 h-48 -translate-y-12 translate-x-12",children:(0,s.jsx)("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-emerald-50 to-blue-50 dark:from-emerald-900/10 dark:to-blue-900/10 opacity-50"})}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6 relative",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-slate-800 dark:text-white",children:"Subscription Details"}),(0,s.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium \n                      ".concat("active"===M.status?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-200":"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-200"),children:M.status?M.status.charAt(0).toUpperCase()+M.status.slice(1):"Active"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 relative",children:[(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Plan"}),(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("span",{className:"text-lg font-medium text-slate-900 dark:text-white mr-2",children:M.planName||(null===(n=M.items)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:null===(r=i.price)||void 0===r?void 0:r.product_name)||(null===(h=p(M.planId))||void 0===h?void 0:h.name)||"Standard"})})]}),M.priceAmount&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Price"}),(0,s.jsx)("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:J(M.priceAmount,M.priceCurrency)})]}),M.formattedPrice&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Price"}),(0,s.jsx)("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:M.formattedPrice})]}),!M.priceAmount&&!M.formattedPrice&&(M.price||(null===(_=M.items)||void 0===_?void 0:null===(N=_[0])||void 0===N?void 0:null===(g=N.price)||void 0===g?void 0:g.unit_price))&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Price"}),(0,s.jsx)("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:M.price?"object"==typeof M.price?J(M.price.amount,M.price.currency):J(M.price,M.priceCurrency||"USD"):J(M.items[0].price.unit_price.amount,M.items[0].price.unit_price.currency_code)})]})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Subscription Date"}),(0,s.jsx)("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:V(M.createdAt)})]}),M.startedAt&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Subscription Start"}),(0,s.jsx)("p",{className:"text-lg font-medium text-slate-900 dark:text-white",children:V(M.startedAt)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-1",children:"Subscription ID"}),(0,s.jsx)("p",{className:"text-sm font-mono text-slate-600 dark:text-slate-400 break-all",children:M.subscriptionId||M.id})]})]})]})]}),(0,s.jsxs)("div",{id:"subscription-plans",className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200/80 dark:border-slate-700/50 p-6 relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 w-96 h-96 -translate-y-48 translate-x-48",children:(0,s.jsx)("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-violet-50 to-purple-50 dark:from-violet-900/10 dark:to-purple-900/10 opacity-50"})}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8 relative",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-slate-800 dark:text-white",children:"Subscription Plans"}),(0,s.jsx)("p",{className:"text-slate-500 dark:text-slate-400 mt-1",children:"Choose the perfect plan for your needs"})]}),(0,s.jsxs)("div",{className:"flex p-1 bg-slate-100 dark:bg-slate-700 rounded-lg",children:[(0,s.jsx)("button",{onClick:()=>k("month"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all ".concat("month"===j?"bg-white dark:bg-slate-600 shadow-sm text-slate-800 dark:text-white":"text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-white"),children:"Monthly"}),(0,s.jsxs)("button",{onClick:()=>k("year"),className:"px-4 py-2 rounded-md text-sm font-medium transition-all ".concat("year"===j?"bg-white dark:bg-slate-600 shadow-sm text-slate-800 dark:text-white":"text-slate-600 dark:text-slate-300 hover:text-slate-800 dark:hover:text-white"),children:["Yearly ",(0,s.jsx)("span",{className:"text-green-400 text-xs ml-1",children:"Save 17%"})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 relative",children:[(0,s.jsxs)("div",{className:"group relative border ".concat((null==C?void 0:C.plan)&&(null===(I=p(C.plan))||void 0===I?void 0:I.name)==="Standard Plan"?"border-blue-300 bg-blue-50/30 dark:bg-blue-900/20":"border-slate-200 dark:border-slate-700"," rounded-2xl p-6 hover:shadow-md hover:border-slate-300 dark:hover:border-slate-600 transition-all duration-300"),children:[(null==C?void 0:C.plan)&&(null===(A=p(C.plan))||void 0===A?void 0:A.name)==="Standard Plan"&&(0,s.jsx)("div",{className:"absolute -top-3 right-6",children:(0,s.jsx)("span",{className:"bg-blue-600 text-white px-3 py-1 rounded-full text-xs font-medium shadow-sm",children:"Current Plan"})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50 to-slate-50 dark:from-blue-900/10 dark:to-slate-800/10 opacity-0 group-hover:opacity-100 transition-opacity rounded-2xl"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-slate-800 dark:text-white mb-2",children:"Standard Plan"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-300 mb-4",children:"month"===j?"Perfect for getting started":"Save more with yearly billing"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("span",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:y.standard||"Loading..."}),(0,s.jsxs)("span",{className:"text-slate-600 dark:text-slate-400",children:["/",j]})]}),(0,s.jsxs)("div",{className:"mb-6 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"Access to basic features"})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"5 projects"})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"Email support"})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"1GB storage"})]})]}),(0,s.jsx)("button",{onClick:()=>U("standard"),disabled:!!(!d||(null==C?void 0:C.plan)&&(null===(T=p(C.plan))||void 0===T?void 0:T.name)==="Standard Plan"&&(null==C?void 0:C.status)==="active"),className:"w-full py-3 px-4 rounded-xl transition-all ".concat(d?(null==C?void 0:C.plan)&&(null===(z=p(C.plan))||void 0===z?void 0:z.name)==="Standard Plan"&&(null==C?void 0:C.status)==="active"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white shadow-sm hover:shadow group-hover:shadow-md":"bg-slate-200 dark:bg-slate-700 cursor-not-allowed text-slate-500 dark:text-slate-400"),children:d?(null==C?void 0:C.plan)&&(null===(L=p(C.plan))||void 0===L?void 0:L.name)==="Standard Plan"&&(null==C?void 0:C.status)==="active"?"Current Plan":"Get Standard ".concat("month"===j?"Monthly":"Yearly"):"Loading..."})]})]}),(0,s.jsxs)("div",{className:"group relative border-2 ".concat((null==C?void 0:C.plan)&&(null===(R=p(C.plan))||void 0===R?void 0:R.name)==="Premium Plan"?"border-violet-300 bg-violet-50/30 dark:bg-violet-900/20":"border-violet-200 dark:border-violet-700"," rounded-2xl p-6 hover:shadow-md hover:border-violet-300 dark:hover:border-violet-600 transition-all duration-300"),children:[(null==C?void 0:C.plan)&&(null===(F=p(C.plan))||void 0===F?void 0:F.name)==="Premium Plan"?(0,s.jsx)("div",{className:"absolute -top-3 right-6",children:(0,s.jsx)("span",{className:"bg-gradient-to-r from-violet-600 to-indigo-600 text-white px-3 py-1 rounded-full text-xs font-medium shadow-sm",children:"Current Plan"})}):(0,s.jsx)("div",{className:"absolute -top-4 left-4",children:(0,s.jsx)("span",{className:"bg-gradient-to-r from-violet-600 to-indigo-600 text-white px-4 py-1 rounded-full text-sm font-medium shadow-sm",children:"Popular"})}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-50 to-indigo-50 dark:from-violet-900/10 dark:to-indigo-900/10 opacity-50 group-hover:opacity-100 transition-opacity rounded-2xl"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-slate-800 dark:text-white mb-2",children:"Premium Plan"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-300 mb-4",children:"month"===j?"Access all premium features":"Best value for full access"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("span",{className:"text-3xl font-bold text-slate-900 dark:text-white",children:y.premium||"Loading..."}),(0,s.jsxs)("span",{className:"text-slate-600 dark:text-slate-400",children:["/",j]})]}),(0,s.jsxs)("div",{className:"mb-6 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-violet-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsxs)("span",{className:"text-slate-700 dark:text-slate-300",children:[(0,s.jsx)("strong",{children:"All Standard features"}),", plus:"]})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-violet-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"Unlimited projects"})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-violet-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"Priority support"})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-violet-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"10GB storage"})]}),(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-violet-500 mt-0.5 mr-3 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,s.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:"Advanced analytics"})]})]}),(0,s.jsx)("button",{onClick:()=>U("premium"),disabled:!!(!d||(null==C?void 0:C.plan)&&(null===(Y=p(C.plan))||void 0===Y?void 0:Y.name)==="Premium Plan"&&(null==C?void 0:C.status)==="active"),className:"w-full py-3 px-4 rounded-xl transition-all ".concat(d?(null==C?void 0:C.plan)&&(null===(W=p(C.plan))||void 0===W?void 0:W.name)==="Premium Plan"&&(null==C?void 0:C.status)==="active"?"bg-violet-100 dark:bg-violet-900/30 text-violet-800 dark:text-violet-200 cursor-not-allowed":"bg-gradient-to-r from-violet-600 to-indigo-600 hover:from-violet-700 hover:to-indigo-700 text-white shadow-sm hover:shadow group-hover:shadow-md":"bg-slate-200 dark:bg-slate-700 cursor-not-allowed text-slate-500 dark:text-slate-400"),children:d?(null==C?void 0:C.plan)&&(null===(X=p(C.plan))||void 0===X?void 0:X.name)==="Premium Plan"&&(null==C?void 0:C.status)==="active"?"Current Plan":"Get Premium ".concat("month"===j?"Monthly":"Yearly"):"Loading..."})]})]})]})]}),E&&E.length>0&&(0,s.jsxs)("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200/80 dark:border-slate-700/50 p-6 overflow-hidden relative",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 w-48 h-48 -translate-y-12 translate-x-12",children:(0,s.jsx)("div",{className:"w-full h-full rounded-full bg-gradient-to-br from-green-50 to-teal-50 dark:from-green-900/10 dark:to-teal-900/10 opacity-50"})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-slate-800 dark:text-white mb-6",children:"Recent Transactions"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:E.map(e=>{var t;return(0,s.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-700/30 rounded-lg p-4 border border-slate-200 dark:border-slate-700",children:[(0,s.jsx)("h4",{className:"text-md font-semibold text-slate-800 dark:text-white mb-2",children:(null===(t=e.product)||void 0===t?void 0:t.name)||"Transaction"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Status:"}),(0,s.jsx)("span",{className:"text-sm font-medium ".concat("completed"===e.paymentStatus||"paid"===e.paymentStatus?"text-green-600 dark:text-green-400":"text-amber-600 dark:text-amber-400"),children:e.paymentStatus?e.paymentStatus.charAt(0).toUpperCase()+e.paymentStatus.slice(1):"Pending"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Amount:"}),(0,s.jsx)("span",{className:"text-sm font-medium text-slate-800 dark:text-slate-200",children:J(e.amountPaid||e.amount,e.currency||"USD")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Date:"}),(0,s.jsx)("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:V(e.timestamp)})]})]})]},e.id)})})]})]})]})]})]}),(0,s.jsx)(w,{isOpen:S,onClose:()=>D(!1)})]})},{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[992,146,235,525,934,340,63,654,441,684,358],()=>t(3005)),_N_E=e.O()}]);